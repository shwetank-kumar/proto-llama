2024-12-15 16:53:19,381 - __main__ - INFO - Output directory: mmlu_pro
2024-12-15 16:53:19,381 - __main__ - INFO - Log file: mmlu_pro/optimization.log
2024-12-15 16:53:19,381 - __main__ - INFO - Database: mmlu_pro/mmlu_pro_optimization.db
2024-12-15 16:53:19,381 - __main__ - INFO - Setting up random seeds
2024-12-15 16:53:19,464 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 16:53:19,503 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 16:53:19,503 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 16:53:19,503 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 16:53:19,503 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 16:53:19,504 - __main__ - INFO - Initializing accelerator
2024-12-15 16:53:19,531 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 16:53:19,531 - __main__ - INFO - Loading tokenizer
2024-12-15 16:53:19,904 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 16:53:19,904 - __main__ - INFO - Loading model
2024-12-15 16:53:34,315 - __main__ - INFO - Model loaded successfully
2024-12-15 16:53:34,315 - __main__ - INFO - Configuring model tokens
2024-12-15 16:53:34,327 - __main__ - INFO - Token configuration completed
2024-12-15 16:53:34,328 - __main__ - INFO - Preparing model with accelerator
2024-12-15 16:53:34,328 - __main__ - INFO - Model preparation completed
2024-12-15 16:53:34,329 - __main__ - INFO - Loading dataset
2024-12-15 16:53:36,380 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 16:53:36,380 - __main__ - INFO - Starting dataset filtering
2024-12-15 16:53:38,381 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 16:53:38,391 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 16:53:38,402 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 16:53:38,412 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 16:53:38,562 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 16:53:38,562 - __main__ - INFO - Environment setup completed successfully
2024-12-15 16:53:38,562 - __main__ - INFO - Creating/loading Optuna study
2024-12-15 16:53:39,343 - __main__ - INFO - Found existing study with 0 completed and 0 failed trials
2024-12-15 16:53:39,344 - __main__ - INFO - Initialization completed successfully
2024-12-15 16:53:39,344 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 16:53:39,346 - __main__ - INFO - Completed trials: 0
2024-12-15 16:53:39,346 - __main__ - INFO - Remaining trials: 20
2024-12-15 16:53:39,346 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 16:53:39,346 - __main__ - INFO - Study name: mmlu_opt_computer science
2024-12-15 16:53:39,346 - __main__ - INFO - Storage: sqlite:///mmlu_pro/mmlu_pro_optimization.db
2024-12-15 16:53:39,347 - __main__ - INFO - --------------------------------------------------
2024-12-15 16:53:39,366 - __main__ - INFO - 
Starting trial 0
2024-12-15 16:53:39,393 - __main__ - INFO - Trial 0 parameters:
2024-12-15 16:53:39,393 - __main__ - INFO - Temperature: 0.4
2024-12-15 16:53:39,393 - __main__ - INFO - Top_p: 1.0
2024-12-15 16:53:39,438 - __main__ - INFO - Running evaluation
2024-12-15 16:54:17,860 - __main__ - INFO - Output directory: mmlu_pro
2024-12-15 16:54:17,860 - __main__ - INFO - Log file: mmlu_pro/optimization.log
2024-12-15 16:54:17,860 - __main__ - INFO - Database: mmlu_pro/mmlu_pro_optimization.db
2024-12-15 16:54:17,860 - __main__ - INFO - Setting up random seeds
2024-12-15 16:54:17,923 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 16:54:17,964 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 16:54:17,964 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 16:54:17,964 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 16:54:17,964 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 16:54:17,964 - __main__ - INFO - Initializing accelerator
2024-12-15 16:54:17,991 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 16:54:17,991 - __main__ - INFO - Loading tokenizer
2024-12-15 16:54:18,391 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 16:54:18,392 - __main__ - INFO - Loading model
2024-12-15 16:54:34,870 - __main__ - INFO - Model loaded successfully
2024-12-15 16:54:34,870 - __main__ - INFO - Configuring model tokens
2024-12-15 16:54:34,880 - __main__ - INFO - Token configuration completed
2024-12-15 16:54:34,880 - __main__ - INFO - Preparing model with accelerator
2024-12-15 16:54:34,880 - __main__ - INFO - Model preparation completed
2024-12-15 16:54:34,880 - __main__ - INFO - Loading dataset
2024-12-15 16:54:37,008 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 16:54:37,009 - __main__ - INFO - Starting dataset filtering
2024-12-15 16:54:38,880 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 16:54:38,890 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 16:54:38,902 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 16:54:38,913 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 16:54:39,066 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 16:54:39,066 - __main__ - INFO - Environment setup completed successfully
2024-12-15 16:54:39,067 - __main__ - INFO - Creating/loading Optuna study
2024-12-15 16:54:39,835 - __main__ - INFO - Found existing study with 0 completed and 1 failed trials
2024-12-15 16:54:39,835 - __main__ - INFO - Initialization completed successfully
2024-12-15 16:54:39,835 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 16:54:39,837 - __main__ - INFO - Completed trials: 0
2024-12-15 16:54:39,837 - __main__ - INFO - Remaining trials: 20
2024-12-15 16:54:39,837 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 16:54:39,837 - __main__ - INFO - Study name: mmlu_opt_computer science
2024-12-15 16:54:39,838 - __main__ - INFO - Storage: sqlite:///mmlu_pro/mmlu_pro_optimization.db
2024-12-15 16:54:39,838 - __main__ - INFO - --------------------------------------------------
2024-12-15 16:54:39,855 - __main__ - INFO - 
Starting trial 1
2024-12-15 16:54:39,880 - __main__ - INFO - Trial 1 parameters:
2024-12-15 16:54:39,880 - __main__ - INFO - Temperature: 0.4
2024-12-15 16:54:39,880 - __main__ - INFO - Top_p: 0.9
2024-12-15 16:54:39,913 - __main__ - INFO - Running evaluation
2024-12-15 17:05:08,583 - __main__ - ERROR - Error during initialization: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
Traceback (most recent call last):
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 71, in __init__
    raise ValueError(f"Study '{study_name}' not found in database")
ValueError: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
2024-12-15 17:05:08,583 - __main__ - ERROR - Fatal error in main
Traceback (most recent call last):
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 335, in main
    optimizer = MMPROOptimizer(
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 71, in __init__
    raise ValueError(f"Study '{study_name}' not found in database")
ValueError: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
2024-12-15 17:07:38,496 - __main__ - ERROR - Error during initialization: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
Traceback (most recent call last):
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 71, in __init__
    raise ValueError(f"Study '{study_name}' not found in database")
ValueError: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
2024-12-15 17:07:38,496 - __main__ - ERROR - Fatal error in main
Traceback (most recent call last):
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 335, in main
    optimizer = MMPROOptimizer(
  File "/mnt/c/code/proto-llama/evaluation/optimize_eval.py", line 71, in __init__
    raise ValueError(f"Study '{study_name}' not found in database")
ValueError: Study 'mmlu_opt_computer_science_20241215_1613' not found in database
2024-12-15 17:07:58,130 - __main__ - INFO - Resuming existing study: mmlu_opt_computer science_20241215_1613
2024-12-15 17:07:58,130 - __main__ - INFO - Setting up random seeds
2024-12-15 17:07:58,257 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 17:07:58,299 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 17:07:58,299 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 17:07:58,299 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 17:07:58,299 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 17:07:58,300 - __main__ - INFO - Initializing accelerator
2024-12-15 17:07:58,342 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 17:07:58,342 - __main__ - INFO - Loading tokenizer
2024-12-15 17:07:58,686 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 17:07:58,686 - __main__ - INFO - Loading model
2024-12-15 17:08:22,243 - __main__ - INFO - Model loaded successfully
2024-12-15 17:08:22,244 - __main__ - INFO - Configuring model tokens
2024-12-15 17:08:22,253 - __main__ - INFO - Token configuration completed
2024-12-15 17:08:22,253 - __main__ - INFO - Preparing model with accelerator
2024-12-15 17:08:22,253 - __main__ - INFO - Model preparation completed
2024-12-15 17:08:22,254 - __main__ - INFO - Loading dataset
2024-12-15 17:08:24,194 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 17:08:24,194 - __main__ - INFO - Starting dataset filtering
2024-12-15 17:08:26,042 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 17:08:26,052 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 17:08:26,062 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 17:08:26,072 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 17:08:26,216 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 17:08:26,216 - __main__ - INFO - Environment setup completed successfully
2024-12-15 17:08:26,345 - __main__ - INFO - Study has 3 completed and 1 failed trials
2024-12-15 17:08:26,345 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 17:08:26,347 - __main__ - INFO - Completed trials: 3
2024-12-15 17:08:26,347 - __main__ - INFO - Remaining trials: 17
2024-12-15 17:08:26,347 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 17:08:26,347 - __main__ - INFO - Study name: mmlu_opt_computer science_20241215_1613
2024-12-15 17:08:26,347 - __main__ - INFO - Storage: sqlite:///mmlu_pro/mmlu_pro_optimization.db
2024-12-15 17:08:26,347 - __main__ - INFO - --------------------------------------------------
2024-12-15 17:08:26,363 - __main__ - INFO - 
Starting trial 4
2024-12-15 17:08:26,385 - __main__ - INFO - Trial 4 parameters:
2024-12-15 17:08:26,385 - __main__ - INFO - Temperature: 0.4
2024-12-15 17:08:26,385 - __main__ - INFO - Top_p: 0.9
2024-12-15 17:08:26,418 - __main__ - INFO - Running evaluation
2024-12-15 17:10:57,179 - __main__ - INFO - Resuming existing study: mmlu_opt_computer science_20241215_1613
2024-12-15 17:10:57,179 - __main__ - INFO - Setting up random seeds
2024-12-15 17:10:57,318 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 17:10:57,364 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 17:10:57,364 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 17:10:57,364 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 17:10:57,364 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 17:10:57,364 - __main__ - INFO - Initializing accelerator
2024-12-15 17:10:57,401 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 17:10:57,401 - __main__ - INFO - Loading tokenizer
2024-12-15 17:10:57,768 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 17:10:57,768 - __main__ - INFO - Loading model
2024-12-15 17:11:20,873 - __main__ - INFO - Model loaded successfully
2024-12-15 17:11:20,873 - __main__ - INFO - Configuring model tokens
2024-12-15 17:11:20,883 - __main__ - INFO - Token configuration completed
2024-12-15 17:11:20,883 - __main__ - INFO - Preparing model with accelerator
2024-12-15 17:11:20,884 - __main__ - INFO - Model preparation completed
2024-12-15 17:11:20,884 - __main__ - INFO - Loading dataset
2024-12-15 17:11:22,972 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 17:11:22,973 - __main__ - INFO - Starting dataset filtering
2024-12-15 17:11:24,949 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 17:11:24,959 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 17:11:24,970 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 17:11:24,981 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 17:11:25,131 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 17:11:25,131 - __main__ - INFO - Environment setup completed successfully
2024-12-15 17:11:25,252 - __main__ - INFO - Study has 3 completed and 2 failed trials
2024-12-15 17:11:25,252 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 17:11:25,254 - __main__ - INFO - Found 3 completed trials
2024-12-15 17:11:25,254 - __main__ - INFO - Found 2 failed trials
2024-12-15 17:11:25,254 - __main__ - INFO - Last failed trial number: 4
2024-12-15 17:11:25,254 - __main__ - INFO - Remaining trials to run: 17
2024-12-15 17:11:25,254 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 17:11:25,255 - __main__ - INFO - Study name: mmlu_opt_computer science_20241215_1613
2024-12-15 17:11:25,255 - __main__ - INFO - --------------------------------------------------
2024-12-15 17:11:25,255 - __main__ - INFO - Retrying failed parameters: {'temperature': 0.4, 'top_p': 0.9}
2024-12-15 17:11:25,272 - __main__ - INFO - 
Starting trial 5
2024-12-15 17:11:25,296 - __main__ - INFO - Trial 5 parameters:
2024-12-15 17:11:25,296 - __main__ - INFO - Temperature: 0.4
2024-12-15 17:11:25,297 - __main__ - INFO - Top_p: 0.9
2024-12-15 17:11:25,330 - __main__ - INFO - Running evaluation
2024-12-15 17:15:16,702 - __main__ - INFO - Creating new study: mmlu_opt_computer science_20241215_1715
2024-12-15 17:15:16,702 - __main__ - INFO - Setting up random seeds
2024-12-15 17:15:16,768 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 17:15:16,813 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 17:15:16,813 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 17:15:16,813 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 17:15:16,813 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 17:15:16,813 - __main__ - INFO - Initializing accelerator
2024-12-15 17:15:16,840 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 17:15:16,840 - __main__ - INFO - Loading tokenizer
2024-12-15 17:15:17,198 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 17:15:17,199 - __main__ - INFO - Loading model
2024-12-15 17:15:32,988 - __main__ - INFO - Model loaded successfully
2024-12-15 17:15:32,988 - __main__ - INFO - Configuring model tokens
2024-12-15 17:15:33,000 - __main__ - INFO - Token configuration completed
2024-12-15 17:15:33,000 - __main__ - INFO - Preparing model with accelerator
2024-12-15 17:15:33,000 - __main__ - INFO - Model preparation completed
2024-12-15 17:15:33,001 - __main__ - INFO - Loading dataset
2024-12-15 17:15:34,977 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 17:15:34,977 - __main__ - INFO - Starting dataset filtering
2024-12-15 17:15:39,003 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 17:15:39,014 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 17:15:39,024 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 17:15:39,035 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 17:15:39,187 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 17:15:39,188 - __main__ - INFO - Environment setup completed successfully
2024-12-15 17:15:39,344 - __main__ - INFO - Study has 0 completed and 0 failed trials
2024-12-15 17:15:39,344 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 17:15:39,347 - __main__ - INFO - Found 0 completed trials
2024-12-15 17:15:39,347 - __main__ - INFO - Found 0 failed trials
2024-12-15 17:15:39,347 - __main__ - INFO - Last failed trial number: -1
2024-12-15 17:15:39,347 - __main__ - INFO - Remaining trials to run: 20
2024-12-15 17:15:39,348 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 17:15:39,348 - __main__ - INFO - Study name: mmlu_opt_computer science_20241215_1715
2024-12-15 17:15:39,348 - __main__ - INFO - --------------------------------------------------
2024-12-15 17:15:39,370 - __main__ - INFO - 
Starting trial 0
2024-12-15 17:15:39,402 - __main__ - INFO - Trial 0 parameters:
2024-12-15 17:15:39,402 - __main__ - INFO - Temperature: 0.4
2024-12-15 17:15:39,402 - __main__ - INFO - Top_p: 0.9
2024-12-15 17:15:39,437 - __main__ - INFO - Running evaluation
2024-12-15 17:23:48,152 - __main__ - INFO - Trial 0 completed with accuracy: 0.3878
2024-12-15 17:23:48,200 - __main__ - INFO - 
Starting trial 1
2024-12-15 17:23:48,222 - __main__ - INFO - Trial 1 parameters:
2024-12-15 17:23:48,222 - __main__ - INFO - Temperature: 0.7
2024-12-15 17:23:48,223 - __main__ - INFO - Top_p: 0.6
2024-12-15 17:23:48,256 - __main__ - INFO - Running evaluation
2024-12-15 17:32:03,586 - __main__ - INFO - Trial 1 completed with accuracy: 0.3805
2024-12-15 17:32:03,630 - __main__ - INFO - 
Starting trial 2
2024-12-15 17:32:03,651 - __main__ - INFO - Trial 2 parameters:
2024-12-15 17:32:03,652 - __main__ - INFO - Temperature: 0.2
2024-12-15 17:32:03,652 - __main__ - INFO - Top_p: 0.2
2024-12-15 17:32:03,682 - __main__ - INFO - Running evaluation
2024-12-15 17:40:22,662 - __main__ - INFO - Trial 2 completed with accuracy: 0.4073
2024-12-15 17:40:22,707 - __main__ - INFO - 
Starting trial 3
2024-12-15 17:40:22,728 - __main__ - INFO - Trial 3 parameters:
2024-12-15 17:40:22,728 - __main__ - INFO - Temperature: 0.1
2024-12-15 17:40:22,728 - __main__ - INFO - Top_p: 0.8
2024-12-15 17:40:22,763 - __main__ - INFO - Running evaluation
2024-12-15 17:48:39,331 - __main__ - INFO - Trial 3 completed with accuracy: 0.4024
2024-12-15 17:48:39,375 - __main__ - INFO - 
Starting trial 4
2024-12-15 17:48:39,398 - __main__ - INFO - Trial 4 parameters:
2024-12-15 17:48:39,398 - __main__ - INFO - Temperature: 0.6
2024-12-15 17:48:39,398 - __main__ - INFO - Top_p: 0.7
2024-12-15 17:48:39,428 - __main__ - INFO - Running evaluation
2024-12-15 17:56:56,503 - __main__ - INFO - Trial 4 completed with accuracy: 0.3878
2024-12-15 17:56:56,549 - __main__ - INFO - 
Starting trial 5
2024-12-15 17:56:56,570 - __main__ - INFO - Trial 5 parameters:
2024-12-15 17:56:56,570 - __main__ - INFO - Temperature: 0.1
2024-12-15 17:56:56,570 - __main__ - INFO - Top_p: 0.9
2024-12-15 17:56:56,603 - __main__ - INFO - Running evaluation
2024-12-15 18:05:15,624 - __main__ - INFO - Trial 5 completed with accuracy: 0.4024
2024-12-15 18:05:15,670 - __main__ - INFO - 
Starting trial 6
2024-12-15 18:05:15,692 - __main__ - INFO - Trial 6 parameters:
2024-12-15 18:05:15,692 - __main__ - INFO - Temperature: 0.8
2024-12-15 18:05:15,692 - __main__ - INFO - Top_p: 0.2
2024-12-15 18:05:15,725 - __main__ - INFO - Running evaluation
2024-12-15 18:13:32,211 - __main__ - INFO - Trial 6 completed with accuracy: 0.3854
2024-12-15 18:13:32,257 - __main__ - INFO - 
Starting trial 7
2024-12-15 18:13:32,279 - __main__ - INFO - Trial 7 parameters:
2024-12-15 18:13:32,280 - __main__ - INFO - Temperature: 0.2
2024-12-15 18:13:32,280 - __main__ - INFO - Top_p: 0.2
2024-12-15 18:13:32,312 - __main__ - INFO - Running evaluation
2024-12-15 18:21:51,332 - __main__ - INFO - Trial 7 completed with accuracy: 0.4073
2024-12-15 18:21:51,378 - __main__ - INFO - 
Starting trial 8
2024-12-15 18:21:51,400 - __main__ - INFO - Trial 8 parameters:
2024-12-15 18:21:51,400 - __main__ - INFO - Temperature: 0.3
2024-12-15 18:21:51,400 - __main__ - INFO - Top_p: 0.5
2024-12-15 18:21:51,432 - __main__ - INFO - Running evaluation
2024-12-15 18:30:08,040 - __main__ - INFO - Trial 8 completed with accuracy: 0.3854
2024-12-15 18:30:08,084 - __main__ - INFO - 
Starting trial 9
2024-12-15 18:30:08,104 - __main__ - INFO - Trial 9 parameters:
2024-12-15 18:30:08,104 - __main__ - INFO - Temperature: 0.4
2024-12-15 18:30:08,104 - __main__ - INFO - Top_p: 0.3
2024-12-15 18:30:08,133 - __main__ - INFO - Running evaluation
2024-12-15 18:38:27,267 - __main__ - INFO - Trial 9 completed with accuracy: 0.3951
2024-12-15 18:38:27,316 - __main__ - INFO - 
Starting trial 10
2024-12-15 18:38:27,349 - __main__ - INFO - Trial 10 parameters:
2024-12-15 18:38:27,349 - __main__ - INFO - Temperature: 0.9
2024-12-15 18:38:27,349 - __main__ - INFO - Top_p: 0.4
2024-12-15 18:38:27,382 - __main__ - INFO - Running evaluation
2024-12-15 18:46:43,970 - __main__ - INFO - Trial 10 completed with accuracy: 0.3390
2024-12-15 18:46:44,014 - __main__ - INFO - 
Starting trial 11
2024-12-15 18:46:44,038 - __main__ - INFO - Trial 11 parameters:
2024-12-15 18:46:44,038 - __main__ - INFO - Temperature: 0.2
2024-12-15 18:46:44,038 - __main__ - INFO - Top_p: 0.1
2024-12-15 18:46:44,069 - __main__ - INFO - Running evaluation
2024-12-15 18:55:00,493 - __main__ - INFO - Trial 11 completed with accuracy: 0.4000
2024-12-15 18:55:00,539 - __main__ - INFO - 
Starting trial 12
2024-12-15 18:55:00,564 - __main__ - INFO - Trial 12 parameters:
2024-12-15 18:55:00,564 - __main__ - INFO - Temperature: 0.3
2024-12-15 18:55:00,564 - __main__ - INFO - Top_p: 0.1
2024-12-15 18:55:00,595 - __main__ - INFO - Running evaluation
2024-12-15 19:03:20,029 - __main__ - INFO - Trial 12 completed with accuracy: 0.4000
2024-12-15 19:03:20,073 - __main__ - INFO - 
Starting trial 13
2024-12-15 19:03:20,097 - __main__ - INFO - Trial 13 parameters:
2024-12-15 19:03:20,097 - __main__ - INFO - Temperature: 0.5
2024-12-15 19:03:20,097 - __main__ - INFO - Top_p: 0.3
2024-12-15 19:03:20,129 - __main__ - INFO - Running evaluation
2024-12-15 19:11:36,506 - __main__ - INFO - Trial 13 completed with accuracy: 0.4024
2024-12-15 19:11:36,549 - __main__ - INFO - 
Starting trial 14
2024-12-15 19:11:36,573 - __main__ - INFO - Trial 14 parameters:
2024-12-15 19:11:36,574 - __main__ - INFO - Temperature: 0.2
2024-12-15 19:11:36,574 - __main__ - INFO - Top_p: 0.3
2024-12-15 19:11:36,608 - __main__ - INFO - Running evaluation
2024-12-15 19:19:52,566 - __main__ - INFO - Trial 14 completed with accuracy: 0.3927
2024-12-15 19:19:52,609 - __main__ - INFO - 
Starting trial 15
2024-12-15 19:19:52,632 - __main__ - INFO - Trial 15 parameters:
2024-12-15 19:19:52,632 - __main__ - INFO - Temperature: 0.2
2024-12-15 19:19:52,632 - __main__ - INFO - Top_p: 0.2
2024-12-15 19:19:52,662 - __main__ - INFO - Running evaluation
2024-12-15 19:28:16,908 - __main__ - INFO - Trial 15 completed with accuracy: 0.4000
2024-12-15 19:28:16,952 - __main__ - INFO - 
Starting trial 16
2024-12-15 19:28:16,976 - __main__ - INFO - Trial 16 parameters:
2024-12-15 19:28:16,976 - __main__ - INFO - Temperature: 0.4
2024-12-15 19:28:16,976 - __main__ - INFO - Top_p: 0.5
2024-12-15 19:28:17,007 - __main__ - INFO - Running evaluation
2024-12-15 19:37:04,128 - __main__ - INFO - Trial 16 completed with accuracy: 0.3829
2024-12-15 19:37:04,174 - __main__ - INFO - 
Starting trial 17
2024-12-15 19:37:04,198 - __main__ - INFO - Trial 17 parameters:
2024-12-15 19:37:04,199 - __main__ - INFO - Temperature: 0.1
2024-12-15 19:37:04,199 - __main__ - INFO - Top_p: 0.2
2024-12-15 19:37:04,230 - __main__ - INFO - Running evaluation
2024-12-15 19:45:47,780 - __main__ - INFO - Trial 17 completed with accuracy: 0.4098
2024-12-15 19:45:47,823 - __main__ - INFO - 
Starting trial 18
2024-12-15 19:45:47,865 - __main__ - INFO - Trial 18 parameters:
2024-12-15 19:45:47,865 - __main__ - INFO - Temperature: 0.1
2024-12-15 19:45:47,865 - __main__ - INFO - Top_p: 0.4
2024-12-15 19:45:47,897 - __main__ - INFO - Running evaluation
2024-12-15 19:54:36,250 - __main__ - INFO - Trial 18 completed with accuracy: 0.3976
2024-12-15 19:54:36,293 - __main__ - INFO - 
Starting trial 19
2024-12-15 19:54:36,318 - __main__ - INFO - Trial 19 parameters:
2024-12-15 19:54:36,318 - __main__ - INFO - Temperature: 0.3
2024-12-15 19:54:36,318 - __main__ - INFO - Top_p: 0.1
2024-12-15 19:54:36,349 - __main__ - INFO - Running evaluation
2024-12-15 20:03:15,529 - __main__ - INFO - Trial 19 completed with accuracy: 0.4024
2024-12-15 20:03:15,568 - __main__ - INFO - Optimization completed successfully
2024-12-15 20:03:15,568 - __main__ - INFO - Best parameters: {'temperature': 0.1, 'top_p': 0.2}
2024-12-15 20:03:15,568 - __main__ - INFO - Best accuracy: 0.4098
2024-12-15 20:03:15,568 - __main__ - INFO - Calculating study statistics
2024-12-15 20:03:18,488 - __main__ - INFO - Statistics calculation completed
2024-12-15 20:20:53,268 - __main__ - INFO - Creating new study: mmlu_opt_computer science_20241215_2020
2024-12-15 20:20:53,268 - __main__ - INFO - Setting up random seeds
2024-12-15 20:20:53,400 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 20:20:53,441 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 20:20:53,442 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 20:20:53,442 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 20:20:53,442 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 20:20:53,442 - __main__ - INFO - Initializing accelerator
2024-12-15 20:20:53,479 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 20:20:53,480 - __main__ - INFO - Loading tokenizer
2024-12-15 20:20:53,832 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 20:20:53,832 - __main__ - INFO - Loading model
2024-12-15 20:21:17,872 - __main__ - INFO - Model loaded successfully
2024-12-15 20:21:17,872 - __main__ - INFO - Configuring model tokens
2024-12-15 20:21:17,882 - __main__ - INFO - Token configuration completed
2024-12-15 20:21:17,882 - __main__ - INFO - Preparing model with accelerator
2024-12-15 20:21:17,882 - __main__ - INFO - Model preparation completed
2024-12-15 20:21:17,882 - __main__ - INFO - Loading dataset
2024-12-15 20:21:20,211 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 20:21:20,211 - __main__ - INFO - Starting dataset filtering
2024-12-15 20:21:22,233 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 20:21:22,243 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 20:21:22,253 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 20:21:22,265 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 20:21:22,409 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 20:21:22,410 - __main__ - INFO - Environment setup completed successfully
2024-12-15 20:21:22,521 - __main__ - INFO - Study has 0 completed and 0 failed trials
2024-12-15 20:21:22,521 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 20:21:22,523 - __main__ - INFO - Found 0 completed trials
2024-12-15 20:21:22,523 - __main__ - INFO - Found 0 failed trials
2024-12-15 20:21:22,523 - __main__ - INFO - Last failed trial number: -1
2024-12-15 20:21:22,524 - __main__ - INFO - Remaining trials to run: 20
2024-12-15 20:21:22,524 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 20:21:22,524 - __main__ - INFO - Study name: mmlu_opt_computer science_20241215_2020
2024-12-15 20:21:22,524 - __main__ - INFO - --------------------------------------------------
2024-12-15 20:21:22,543 - __main__ - INFO - 
Starting trial 0
2024-12-15 20:21:22,567 - __main__ - INFO - Trial 0 parameters:
2024-12-15 20:21:22,567 - __main__ - INFO - Temperature: 0.4
2024-12-15 20:21:22,568 - __main__ - INFO - Top_p: 0.9
2024-12-15 20:21:22,599 - __main__ - INFO - Running evaluation
2024-12-15 20:40:43,023 - __main__ - INFO - Creating new study: mmlu_opt_computer science_20241215_2040
2024-12-15 20:40:43,023 - __main__ - INFO - Setting up random seeds
2024-12-15 20:40:43,157 - __main__ - INFO - CUDA is available. GPU information:
2024-12-15 20:40:43,199 - __main__ - INFO - GPU 0: NVIDIA GeForce RTX 3090
2024-12-15 20:40:43,200 - __main__ - INFO - Free memory on GPU 0: 24575.50 MB
2024-12-15 20:40:43,201 - __main__ - INFO - GPU 1: NVIDIA GeForce RTX 3090
2024-12-15 20:40:43,201 - __main__ - INFO - Free memory on GPU 1: 24575.50 MB
2024-12-15 20:40:43,201 - __main__ - INFO - Initializing accelerator
2024-12-15 20:40:43,240 - __main__ - INFO - Accelerator initialized successfully
2024-12-15 20:40:43,240 - __main__ - INFO - Loading tokenizer
2024-12-15 20:40:43,626 - __main__ - INFO - Tokenizer loaded successfully
2024-12-15 20:40:43,626 - __main__ - INFO - Loading model
2024-12-15 20:41:07,195 - __main__ - INFO - Model loaded successfully
2024-12-15 20:41:07,195 - __main__ - INFO - Configuring model tokens
2024-12-15 20:41:07,206 - __main__ - INFO - Token configuration completed
2024-12-15 20:41:07,206 - __main__ - INFO - Preparing model with accelerator
2024-12-15 20:41:07,206 - __main__ - INFO - Model preparation completed
2024-12-15 20:41:07,206 - __main__ - INFO - Loading dataset
2024-12-15 20:41:09,300 - __main__ - INFO - Dataset loaded, filtering by subject
2024-12-15 20:41:09,301 - __main__ - INFO - Starting dataset filtering
2024-12-15 20:41:11,219 - __main__ - INFO - Processed batch, current size: 100
2024-12-15 20:41:11,228 - __main__ - INFO - Processed batch, current size: 200
2024-12-15 20:41:11,239 - __main__ - INFO - Processed batch, current size: 300
2024-12-15 20:41:11,250 - __main__ - INFO - Processed batch, current size: 400
2024-12-15 20:41:11,399 - __main__ - INFO - Dataset filtered, size: 410
2024-12-15 20:41:11,399 - __main__ - INFO - Environment setup completed successfully
2024-12-15 20:41:11,511 - __main__ - INFO - Study has 0 completed and 0 failed trials
2024-12-15 20:41:11,511 - __main__ - INFO - 
Starting/Resuming optimization for subject: computer science
2024-12-15 20:41:11,512 - __main__ - INFO - Found 0 completed trials
2024-12-15 20:41:11,512 - __main__ - INFO - Found 0 failed trials
2024-12-15 20:41:11,513 - __main__ - INFO - Last failed trial number: -1
2024-12-15 20:41:11,513 - __main__ - INFO - Remaining trials to run: 20
2024-12-15 20:41:11,513 - __main__ - INFO - Model: meta-llama/Llama-3.1-8B-Instruct
2024-12-15 20:41:11,513 - __main__ - INFO - Study name: mmlu_opt_computer science_20241215_2040
2024-12-15 20:41:11,513 - __main__ - INFO - --------------------------------------------------
2024-12-15 20:41:11,530 - __main__ - INFO - 
Starting trial 0
2024-12-15 20:41:11,554 - __main__ - INFO - Trial 0 parameters:
2024-12-15 20:41:11,555 - __main__ - INFO - Temperature: 0.4
2024-12-15 20:41:11,555 - __main__ - INFO - Top_p: 0.9
2024-12-15 20:41:11,585 - __main__ - INFO - Running evaluation
2024-12-15 20:57:34,838 - __main__ - INFO - Trial 0 completed with accuracy: 0.4073
2024-12-15 20:57:34,891 - __main__ - INFO - 
Starting trial 1
2024-12-15 20:57:34,914 - __main__ - INFO - Trial 1 parameters:
2024-12-15 20:57:34,914 - __main__ - INFO - Temperature: 0.7
2024-12-15 20:57:34,914 - __main__ - INFO - Top_p: 0.6
2024-12-15 20:57:34,943 - __main__ - INFO - Running evaluation
2024-12-15 21:14:36,854 - __main__ - INFO - Trial 1 completed with accuracy: 0.4195
2024-12-15 21:14:36,899 - __main__ - INFO - 
Starting trial 2
2024-12-15 21:14:36,920 - __main__ - INFO - Trial 2 parameters:
2024-12-15 21:14:36,920 - __main__ - INFO - Temperature: 0.2
2024-12-15 21:14:36,921 - __main__ - INFO - Top_p: 0.2
2024-12-15 21:14:36,955 - __main__ - INFO - Running evaluation
2024-12-15 21:32:14,672 - __main__ - INFO - Trial 2 completed with accuracy: 0.4317
2024-12-15 21:32:14,715 - __main__ - INFO - 
Starting trial 3
2024-12-15 21:32:14,735 - __main__ - INFO - Trial 3 parameters:
2024-12-15 21:32:14,735 - __main__ - INFO - Temperature: 0.1
2024-12-15 21:32:14,735 - __main__ - INFO - Top_p: 0.8
2024-12-15 21:32:14,766 - __main__ - INFO - Running evaluation
2024-12-15 21:50:02,772 - __main__ - INFO - Trial 3 completed with accuracy: 0.4073
2024-12-15 21:50:02,816 - __main__ - INFO - 
Starting trial 4
2024-12-15 21:50:02,837 - __main__ - INFO - Trial 4 parameters:
2024-12-15 21:50:02,837 - __main__ - INFO - Temperature: 0.6
2024-12-15 21:50:02,837 - __main__ - INFO - Top_p: 0.7
2024-12-15 21:50:02,868 - __main__ - INFO - Running evaluation
2024-12-15 22:08:18,911 - __main__ - INFO - Trial 4 completed with accuracy: 0.4098
2024-12-15 22:08:18,955 - __main__ - INFO - 
Starting trial 5
2024-12-15 22:08:18,976 - __main__ - INFO - Trial 5 parameters:
2024-12-15 22:08:18,976 - __main__ - INFO - Temperature: 0.1
2024-12-15 22:08:18,976 - __main__ - INFO - Top_p: 0.9
2024-12-15 22:08:19,009 - __main__ - INFO - Running evaluation
2024-12-15 22:26:39,453 - __main__ - INFO - Trial 5 completed with accuracy: 0.4195
2024-12-15 22:26:39,497 - __main__ - INFO - 
Starting trial 6
2024-12-15 22:26:39,518 - __main__ - INFO - Trial 6 parameters:
2024-12-15 22:26:39,518 - __main__ - INFO - Temperature: 0.8
2024-12-15 22:26:39,518 - __main__ - INFO - Top_p: 0.2
2024-12-15 22:26:39,548 - __main__ - INFO - Running evaluation
2024-12-15 22:44:59,594 - __main__ - INFO - Trial 6 completed with accuracy: 0.4390
2024-12-15 22:44:59,642 - __main__ - INFO - 
Starting trial 7
2024-12-15 22:44:59,665 - __main__ - INFO - Trial 7 parameters:
2024-12-15 22:44:59,665 - __main__ - INFO - Temperature: 0.2
2024-12-15 22:44:59,665 - __main__ - INFO - Top_p: 0.2
2024-12-15 22:44:59,700 - __main__ - INFO - Running evaluation
2024-12-15 23:03:28,299 - __main__ - INFO - Trial 7 completed with accuracy: 0.4317
2024-12-15 23:03:28,343 - __main__ - INFO - 
Starting trial 8
2024-12-15 23:03:28,364 - __main__ - INFO - Trial 8 parameters:
2024-12-15 23:03:28,365 - __main__ - INFO - Temperature: 0.3
2024-12-15 23:03:28,365 - __main__ - INFO - Top_p: 0.5
2024-12-15 23:03:28,395 - __main__ - INFO - Running evaluation
2024-12-15 23:22:00,911 - __main__ - INFO - Trial 8 completed with accuracy: 0.4024
2024-12-15 23:22:00,955 - __main__ - INFO - 
Starting trial 9
2024-12-15 23:22:00,977 - __main__ - INFO - Trial 9 parameters:
2024-12-15 23:22:00,977 - __main__ - INFO - Temperature: 0.4
2024-12-15 23:22:00,977 - __main__ - INFO - Top_p: 0.3
2024-12-15 23:22:01,006 - __main__ - INFO - Running evaluation
2024-12-15 23:40:34,587 - __main__ - INFO - Trial 9 completed with accuracy: 0.4244
2024-12-15 23:40:34,631 - __main__ - INFO - 
Starting trial 10
2024-12-15 23:40:34,662 - __main__ - INFO - Trial 10 parameters:
2024-12-15 23:40:34,663 - __main__ - INFO - Temperature: 0.9
2024-12-15 23:40:34,663 - __main__ - INFO - Top_p: 0.4
2024-12-15 23:40:34,693 - __main__ - INFO - Running evaluation
2024-12-15 23:59:17,785 - __main__ - INFO - Trial 10 completed with accuracy: 0.4317
2024-12-15 23:59:17,828 - __main__ - INFO - 
Starting trial 11
2024-12-15 23:59:17,851 - __main__ - INFO - Trial 11 parameters:
2024-12-15 23:59:17,852 - __main__ - INFO - Temperature: 0.9
2024-12-15 23:59:17,852 - __main__ - INFO - Top_p: 0.1
2024-12-15 23:59:17,885 - __main__ - INFO - Running evaluation
2024-12-16 00:18:01,355 - __main__ - INFO - Trial 11 completed with accuracy: 0.4317
2024-12-16 00:18:01,399 - __main__ - INFO - 
Starting trial 12
2024-12-16 00:18:01,422 - __main__ - INFO - Trial 12 parameters:
2024-12-16 00:18:01,422 - __main__ - INFO - Temperature: 0.7
2024-12-16 00:18:01,422 - __main__ - INFO - Top_p: 0.1
2024-12-16 00:18:01,452 - __main__ - INFO - Running evaluation
2024-12-16 00:36:32,413 - __main__ - INFO - Trial 12 completed with accuracy: 0.4366
2024-12-16 00:36:32,458 - __main__ - INFO - 
Starting trial 13
2024-12-16 00:36:32,481 - __main__ - INFO - Trial 13 parameters:
2024-12-16 00:36:32,482 - __main__ - INFO - Temperature: 0.7
2024-12-16 00:36:32,482 - __main__ - INFO - Top_p: 0.1
2024-12-16 00:36:32,512 - __main__ - INFO - Running evaluation
2024-12-16 00:55:05,701 - __main__ - INFO - Trial 13 completed with accuracy: 0.4341
2024-12-16 00:55:05,745 - __main__ - INFO - 
Starting trial 14
2024-12-16 00:55:05,768 - __main__ - INFO - Trial 14 parameters:
2024-12-16 00:55:05,768 - __main__ - INFO - Temperature: 0.8
2024-12-16 00:55:05,768 - __main__ - INFO - Top_p: 0.3
2024-12-16 00:55:05,799 - __main__ - INFO - Running evaluation
2024-12-16 01:13:27,740 - __main__ - INFO - Trial 14 completed with accuracy: 0.4024
2024-12-16 01:13:27,787 - __main__ - INFO - 
Starting trial 15
2024-12-16 01:13:27,809 - __main__ - INFO - Trial 15 parameters:
2024-12-16 01:13:27,809 - __main__ - INFO - Temperature: 0.6
2024-12-16 01:13:27,809 - __main__ - INFO - Top_p: 0.1
2024-12-16 01:13:27,841 - __main__ - INFO - Running evaluation
2024-12-16 01:32:10,788 - __main__ - INFO - Trial 15 completed with accuracy: 0.4317
2024-12-16 01:32:10,832 - __main__ - INFO - 
Starting trial 16
2024-12-16 01:32:10,855 - __main__ - INFO - Trial 16 parameters:
2024-12-16 01:32:10,855 - __main__ - INFO - Temperature: 0.8
2024-12-16 01:32:10,855 - __main__ - INFO - Top_p: 0.3
2024-12-16 01:32:10,886 - __main__ - INFO - Running evaluation
2024-12-16 01:50:52,831 - __main__ - INFO - Trial 16 completed with accuracy: 0.4098
2024-12-16 01:50:52,878 - __main__ - INFO - 
Starting trial 17
2024-12-16 01:50:52,904 - __main__ - INFO - Trial 17 parameters:
2024-12-16 01:50:52,904 - __main__ - INFO - Temperature: 0.6
2024-12-16 01:50:52,904 - __main__ - INFO - Top_p: 0.5
2024-12-16 01:50:52,937 - __main__ - INFO - Running evaluation
2024-12-16 02:09:21,650 - __main__ - INFO - Trial 17 completed with accuracy: 0.4244
2024-12-16 02:09:21,700 - __main__ - INFO - 
Starting trial 18
2024-12-16 02:09:21,727 - __main__ - INFO - Trial 18 parameters:
2024-12-16 02:09:21,727 - __main__ - INFO - Temperature: 0.8
2024-12-16 02:09:21,727 - __main__ - INFO - Top_p: 0.2
2024-12-16 02:09:21,762 - __main__ - INFO - Running evaluation
2024-12-16 02:27:41,171 - __main__ - INFO - Trial 18 completed with accuracy: 0.4439
2024-12-16 02:27:41,215 - __main__ - INFO - 
Starting trial 19
2024-12-16 02:27:41,239 - __main__ - INFO - Trial 19 parameters:
2024-12-16 02:27:41,240 - __main__ - INFO - Temperature: 0.8
2024-12-16 02:27:41,240 - __main__ - INFO - Top_p: 0.4
2024-12-16 02:27:41,270 - __main__ - INFO - Running evaluation
2024-12-16 02:45:57,207 - __main__ - INFO - Trial 19 completed with accuracy: 0.4024
2024-12-16 02:45:57,247 - __main__ - INFO - Optimization completed successfully
2024-12-16 02:45:57,247 - __main__ - INFO - Best parameters: {'temperature': 0.8, 'top_p': 0.2}
2024-12-16 02:45:57,247 - __main__ - INFO - Best accuracy: 0.4439
2024-12-16 02:45:57,247 - __main__ - INFO - Calculating study statistics
2024-12-16 02:45:58,396 - __main__ - INFO - Statistics calculation completed
